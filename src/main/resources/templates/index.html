<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <title th:text="|Screencast@${hostname}|">Screencast@localhost</title>

  <script src="/webjars/jquery/jquery.min.js"></script>
  <script src="/webjars/mustache/mustache.min.js"></script>
  <script src="/webjars/sockjs-client/sockjs.min.js"></script>
  <script src="/webjars/stomp-websocket/stomp.min.js"></script>
  <script src="/webjars/moment/min/moment.min.js"></script>
  <script src="/webjars/moment/locale/de.js"></script>

  <link rel="stylesheet" href="css/app.css"/>
  <script src="/webjars/bootstrap/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="/webjars/bootstrap/css/bootstrap.min.css"/>

  <script src="js/app.js"></script>
</head>
<body th:with="isWatcher = (${requestType} == 'watcher'),isCaster = (${requestType} == 'caster')">

<script th:if="${isCaster}">

  $(document).ready(function () {
    //disable local notifications
    screenCaster.notificationStatus.enabled = false;
  });
</script>

<script th:inline="javascript">
  /*<![CDATA[*/
  $(document).ready(function () {
    screenCaster.enabled = /*[[${settings.castEnabled}]]*/;
  });
  /*]]>*/
</script>

<main>
  <div id="screenContainer" data-xxx="th:if='${isWatcher}'" class="container-fluid">
    <div class="row">
      <img id="screen" src="/screenshot" class="screen-fit img-responsive" unselectable="on"
           onselectstart="return false;"/>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <button id="btnShowNotes" type="button" class="btn btn-info btn-lg" data-toggle="modal"
              data-target="#notesDialog">
        Notes
        <span id="unreadNotesCounter" class="badge">0</span>

      </button>

      <!--<div id="castInfo" th:if="${isCaster}" class="col col-md-8">-->
      <!--<h2>Screencast Status: <span id="screenCastStatus">active</span> URL: <span th:text="${screencastUrl}"/></h2>-->
      <!--</div>-->
    </div>

    <div class="row">
      <div id="castInfo" th:if="${isCaster &amp;&amp; false}" class="jumbotron">
        <h1>Screencast</h1>
        <h2>URL: <span th:text="${screencastUrl}"/></h2>
        <p>Status: <span id="screenCastStatus" th:text="${settings.castEnabled} ? 'active' : 'not active'">active</span>
        </p>
      </div>
    </div>
  </div>

  <div id="notesDialog" class="modal fade" role="dialog" tabindex="-1">

    <div id="notesDialogBox" class="modal-dialog panel panel-default">

      <div class="modal-header panel-heading">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h2 class="modal-title">Notes</h2>
      </div>

      <div class="modal-body panel panel-body">

        <div id="notesListContainer">
          <ol id="notesList" class="list-group"></ol>
        </div>

        <form id="notesForm" action="/notes" method="post" th:if="${isCaster}">
          <hr/>
          <div class="form-group">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <label for="txtNote">New Note</label>
            <textarea id="txtNote" name="text" th:required="required" class="form-control" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Sent</button>
          <button type="reset" class="btn">Reset</button>
        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>

</main>
<script id="note-template" type="x-tmpl-mustache">
  <li data-note-id="{{id}}" class="list-group-item">
    <div class="note new" onmouseover="markNoteAsRead(this);">
      <p>{{{text}}}</p>
      <div>
        <form class="note-actions" action="/notes/{{id}}" onsubmit="return false;" th:if="${isCaster}">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" class="csrf" />

            <ul class="list-inline">
              <span class="note-time">{{createdAtHuman}}</span>
              <button type="submit" onclick="updateNote(event)" name="action" value="delete" class="glyphicon glyphicon-trash"/>
              <span class="new-note-marker glyphicon glyphicon-asterisk"/>
            </ul>
        </form>
      </div>
    </div>
  </li>
</script>
</body>
</html>